<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Wabb | Library</title>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700&family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='library.css') }}">
</head>
<body>

<header>
    <div class="logo">Wabb</div>
    <nav>
        <a href="{{ url_for('home') }}">Home</a>
        <a href="{{ url_for('create') }}">Create</a>
        <a href="{{ url_for('library') }}">Library</a>
    </nav>
</header>

<section id="library">
    <h2>Your Story Library</h2>
    <div class="library-container" id="library-list">

        <!-- ORIGINAL STORIES (KEEPING YOUR OLD CONTENT) -->
        <div class="story-card">
            <h3>The Silent Dawn</h3>
            <img src="{{ url_for('static', filename='book2.jpg') }}" alt="Story Cover" class="story-img">
            <p class="author">by Alina Cruz</p>
            <button onclick="readStoryStatic('The Silent Dawn', 'Alina Cruz', 'A world drowned in silence hides secrets only the brave dare to uncover... Full story content goes here.')">Read More</button>
        </div>

        <div class="story-card">
            <h3>Shadows of the Hallway</h3>
            <img src="{{ url_for('static', filename='book1.jpg') }}" alt="Story Cover" class="story-img">
            <p class="author">by Lucien Reyes</p>
            <button onclick="readStoryStatic('Shadows of the Hallway', 'Lucien Reyes', 'When night falls, Section D’s hallway tells stories of the past... Full story content goes here.')">Read More</button>
        </div>

    </div>

    <div id="story-viewer" class="story-output" style="display:none;">
        <button class="back-btn" onclick="backToLibrary()">← Back to Library</button>
        <h2 id="view-title"></h2>
        <h4 id="view-author"></h4>
        <img id="view-photo" style="max-width: 400px; border-radius: 15px; margin: 20px 0;">
        <p id="view-content"></p>
    </div>
</section>

<script>
function loadLibrary() {
    const list = document.getElementById('library-list');
    const stories = JSON.parse(localStorage.getItem('stories')) || [];

    stories.forEach((story, index) => {
        const card = document.createElement('div');
        card.classList.add('story-card');
        card.innerHTML = `
            <h3>${story.title}</h3>
            <img src="${story.photo}" alt="Story Cover" class="story-img">
            <p class="author">by ${story.author}</p>
            <button onclick="readStoryDynamic(${index})">Read More</button>
        `;
        list.appendChild(card);
    });
}

function readStoryStatic(title, author, content) {
    document.getElementById('library-list').style.display = 'none';
    document.getElementById('story-viewer').style.display = 'block';
    document.getElementById('view-title').textContent = title;
    document.getElementById('view-author').textContent = "by " + author;
    document.getElementById('view-photo').style.display = 'none';
    document.getElementById('view-content').textContent = content;
}

function readStoryDynamic(index) {
    const stories = JSON.parse(localStorage.getItem('stories')) || [];
    const story = stories[index];
    document.getElementById('library-list').style.display = 'none';
    document.getElementById('story-viewer').style.display = 'block';
    document.getElementById('view-title').textContent = story.title;
    document.getElementById('view-author').textContent = "by " + story.author;
    document.getElementById('view-photo').src = story.photo;
    document.getElementById('view-photo').style.display = 'block';
    document.getElementById('view-content').textContent = story.chapter;
}

function backToLibrary() {
    document.getElementById('story-viewer').style.display = 'none';
    document.getElementById('library-list').style.display = 'grid';
}

window.onload = loadLibrary;
</script>

</body>
</html>
